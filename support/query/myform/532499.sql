BEGIN TRANSACTION 
select * FROM dbo.AGREEMENT_ASSET_AMORTIZATION where AGREEMENT_NO = '0003650.4.08.01.2025' order by ASSET_NO
SELECT FIRST_PAYMENT_TYPE,* FROM dbo.AGREEMENT_MAIN where AGREEMENT_NO = '0003650.4.08.01.2025'
SELECT FIRST_PAYMENT_TYPE,* FROM dbo.AGREEMENT_ASSET where AGREEMENT_NO = '0003650.4.08.01.2025'
SELECT FIRST_PAYMENT_TYPE,* FROM dbo.APPLICATION_MAIN where APPLICATION_NO = '0003636.4.08.12.2024'

update AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-03-15', BILLING_DATE = '2025-02-13', BILLING_AMOUNT = 10200000 ,mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-532499' where ASSET_NO = '2008.OPLAA.2412.000163' and BILLING_NO = 1
update AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-06-12', BILLING_DATE = '2025-05-13', BILLING_AMOUNT = 10200000 ,mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-532499' where ASSET_NO = '2008.OPLAA.2412.000163' and BILLING_NO = 2
update AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-09-12', BILLING_DATE = '2025-08-13', BILLING_AMOUNT = 10200000 ,mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-532499' where ASSET_NO = '2008.OPLAA.2412.000163' and BILLING_NO = 3
update AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-12-13', BILLING_DATE = '2025-11-13', BILLING_AMOUNT = 10200000 ,mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-532499' where ASSET_NO = '2008.OPLAA.2412.000163' and BILLING_NO = 4


update AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-03-15', BILLING_DATE = '2025-02-13', BILLING_AMOUNT = 10200000 ,mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-532499' where ASSET_NO = '2008.OPLAA.2412.000165' and BILLING_NO = 1
update AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-06-12', BILLING_DATE = '2025-05-13', BILLING_AMOUNT = 10200000 ,mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-532499' where ASSET_NO = '2008.OPLAA.2412.000165' and BILLING_NO = 2
update AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-09-12', BILLING_DATE = '2025-08-13', BILLING_AMOUNT = 10200000 ,mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-532499' where ASSET_NO = '2008.OPLAA.2412.000165' and BILLING_NO = 3
update AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-12-13', BILLING_DATE = '2025-11-13', BILLING_AMOUNT = 10200000 ,mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-532499' where ASSET_NO = '2008.OPLAA.2412.000165' and BILLING_NO = 4

update AGREEMENT_MAIN	set FIRST_PAYMENT_TYPE = 'ADV' ,mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-532499' where AGREEMENT_NO = '0003650.4.08.01.2025'
update AGREEMENT_ASSET	set FIRST_PAYMENT_TYPE = 'ADV' ,mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-532499' where AGREEMENT_NO = '0003650.4.08.01.2025'
update APPLICATION_MAIN	set FIRST_PAYMENT_TYPE = 'ADV' ,mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-532499' where APPLICATION_NO = '0003636.4.08.12.2024'

select * FROM dbo.AGREEMENT_ASSET_AMORTIZATION where AGREEMENT_NO = '0003650.4.08.01.2025' order by ASSET_NO
SELECT FIRST_PAYMENT_TYPE,* FROM dbo.AGREEMENT_MAIN where AGREEMENT_NO = '0003650.4.08.01.2025'
SELECT FIRST_PAYMENT_TYPE,* FROM dbo.AGREEMENT_ASSET where AGREEMENT_NO = '0003650.4.08.01.2025'
SELECT FIRST_PAYMENT_TYPE,* FROM dbo.APPLICATION_MAIN where APPLICATION_NO = '0003636.4.08.12.2024'

DECLARE @variable VARCHAR(50);

DECLARE reff_cursor CURSOR FOR
SELECT variable
FROM (
    VALUES
    ('B9260PXA'),
    ('B9262PXA'),
    ('B9257PXA'),
    ('B9224PXA'),
    ('B9255PXA')
) AS RefNos(variable);

OPEN reff_cursor;
FETCH NEXT FROM reff_cursor INTO @variable;

WHILE @@FETCH_STATUS = 0
BEGIN
    INSERT INTO MTN_DATA_DSF_LOG
    (   
        MAINTENANCE_NAME
        ,REMARK
        ,TABEL_UTAMA
        ,REFF_1
        ,REFF_2
        ,REFF_3
        ,CRE_DATE
        ,CRE_BY
    )
    VALUES
    (   
        'MTN MyForm 532499'
        ,'Merubah First Payment Type & Schedule amortisasi CV TALIN SUKSES INDONESIA nomor Aplikasi 0003636/4/08/12/2024 nomor AGR 0003650/4/08/01/2025
'
        ,'AGREEMENT_ASSET_AMORTIZATION'
        ,'0002745.4.38.08.2024'
        ,@variable
        ,null
        ,GETDATE()
        ,'fauzan'
    );

    FETCH NEXT FROM reff_cursor INTO @variable;
END

CLOSE reff_cursor;
DEALLOCATE reff_cursor;


ROLLBACK TRANSACTION 