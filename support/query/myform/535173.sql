--SELECT * FROM INVOICE join dbo.AGREEMENT_ASSET_AMORTIZATION on AGREEMENT_ASSET_AMORTIZATION.INVOICE_NO = INVOICE.INVOICE_NO where AGREEMENT_ASSET_AMORTIZATION.ASSET_NO in
--(
--'2008.OPLAA.2402.000204','2008.OPLAA.2402.000207','2008.OPLAA.2402.000208','2008.OPLAA.2403.000039'
--)
BEGIN TRANSACTION 
    SELECT * FROM dbo.AGREEMENT_ASSET_AMORTIZATION where AGREEMENT_NO = '0002009.4.08.02.2024'
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-03-31', BILLING_DATE = '2025-03-31', BILLING_AMOUNT = 3150000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002009.4.08.02.2024' and  BILLING_NO = 13
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-04-30', BILLING_DATE = '2025-04-30', BILLING_AMOUNT = 3150000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002009.4.08.02.2024' and  BILLING_NO = 14
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-05-31', BILLING_DATE = '2025-05-31', BILLING_AMOUNT = 3150000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002009.4.08.02.2024' and  BILLING_NO = 15
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-06-30', BILLING_DATE = '2025-06-30', BILLING_AMOUNT = 3150000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002009.4.08.02.2024' and  BILLING_NO = 16
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-07-31', BILLING_DATE = '2025-07-31', BILLING_AMOUNT = 3150000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002009.4.08.02.2024' and  BILLING_NO = 17
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-08-31', BILLING_DATE = '2025-08-31', BILLING_AMOUNT = 3150000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002009.4.08.02.2024' and  BILLING_NO = 18
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-09-04', BILLING_DATE = '2025-09-04', BILLING_AMOUNT = 406452  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002009.4.08.02.2024' and  BILLING_NO = 19
    SELECT * FROM dbo.AGREEMENT_ASSET_AMORTIZATION where AGREEMENT_NO = '0002009.4.08.02.2024'
ROLLBACK TRANSACTION 
BEGIN TRANSACTION 
	select * FROM dbo.AGREEMENT_ASSET_AMORTIZATION where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000204'
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-03-31', BILLING_DATE = '2025-03-31', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000204' and  BILLING_NO = 13
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-04-30', BILLING_DATE = '2025-04-30', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000204' and  BILLING_NO = 14
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-05-31', BILLING_DATE = '2025-05-31', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000204' and  BILLING_NO = 15
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-06-30', BILLING_DATE = '2025-06-30', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000204' and  BILLING_NO = 16
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-07-31', BILLING_DATE = '2025-07-31', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000204' and  BILLING_NO = 17
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-08-31', BILLING_DATE = '2025-08-31', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000204' and  BILLING_NO = 18
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-09-22', BILLING_DATE = '2025-09-22', BILLING_AMOUNT = 2200000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000204' and  BILLING_NO = 19
	select * FROM dbo.AGREEMENT_ASSET_AMORTIZATION where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000204'
ROLLBACK TRANSACTION 
BEGIN TRANSACTION 
	select * FROM dbo.AGREEMENT_ASSET_AMORTIZATION where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000207'
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-03-31', BILLING_DATE = '2025-03-31', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000207' and  BILLING_NO = 13
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-04-30', BILLING_DATE = '2025-04-30', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000207' and  BILLING_NO = 14
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-05-31', BILLING_DATE = '2025-05-31', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000207' and  BILLING_NO = 15
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-06-30', BILLING_DATE = '2025-06-30', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000207' and  BILLING_NO = 16
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-07-31', BILLING_DATE = '2025-07-31', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000207' and  BILLING_NO = 17
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-08-31', BILLING_DATE = '2025-08-31', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000207' and  BILLING_NO = 18
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-09-22', BILLING_DATE = '2025-09-22', BILLING_AMOUNT = 2200000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000207' and  BILLING_NO = 19
	select * FROM dbo.AGREEMENT_ASSET_AMORTIZATION where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000207'
ROLLBACK TRANSACTION 
BEGIN TRANSACTION 
	select * FROM dbo.AGREEMENT_ASSET_AMORTIZATION where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000208'
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-03-31', BILLING_DATE = '2025-03-31', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000208' and  BILLING_NO = 13
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-04-30', BILLING_DATE = '2025-04-30', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000208' and  BILLING_NO = 14
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-05-31', BILLING_DATE = '2025-05-31', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000208' and  BILLING_NO = 15
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-06-30', BILLING_DATE = '2025-06-30', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000208' and  BILLING_NO = 16
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-07-31', BILLING_DATE = '2025-07-31', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000208' and  BILLING_NO = 17
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-08-31', BILLING_DATE = '2025-08-31', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000208' and  BILLING_NO = 18
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-09-22', BILLING_DATE = '2025-09-22', BILLING_AMOUNT = 2200000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000208' and  BILLING_NO = 19
	select * FROM dbo.AGREEMENT_ASSET_AMORTIZATION where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2402.000208'
ROLLBACK TRANSACTION 
BEGIN TRANSACTION 
	select * FROM dbo.AGREEMENT_ASSET_AMORTIZATION where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2403.000039'
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-03-31', BILLING_DATE = '2025-03-31', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2403.000039' and  BILLING_NO = 13
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-04-30', BILLING_DATE = '2025-04-30', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2403.000039' and  BILLING_NO = 14
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-05-31', BILLING_DATE = '2025-05-31', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2403.000039' and  BILLING_NO = 15
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-06-30', BILLING_DATE = '2025-06-30', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2403.000039' and  BILLING_NO = 16
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-07-31', BILLING_DATE = '2025-07-31', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2403.000039' and  BILLING_NO = 17
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-08-31', BILLING_DATE = '2025-08-31', BILLING_AMOUNT = 3100000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2403.000039' and  BILLING_NO = 18
update dbo.AGREEMENT_ASSET_AMORTIZATION set DUE_DATE = '2025-09-22', BILLING_DATE = '2025-09-22', BILLING_AMOUNT = 2200000  , mod_date = GETDATE() ,mod_by = 'MTN_FAUZAN', mod_ip_address = 'MYFORM-535173' where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2403.000039' and  BILLING_NO = 19
	select * FROM dbo.AGREEMENT_ASSET_AMORTIZATION where AGREEMENT_NO = '0002072.4.08.03.2024' and ASSET_NO = '2008.OPLAA.2403.000039'
ROLLBACK TRANSACTION 
