BEGIN TRANSACTION 
SELECT * into XXX_INVOICE_220425 FROM dbo.INVOICE
SELECT * into XXX_AGREEMENT_OBLIGATION_220425 FROM dbo.AGREEMENT_OBLIGATION
SELECT * FROM dbo.INVOICE WHERE INVOICE_NO IN ( 
'33578.INV.2004.12.2024'
,'33577.INV.2004.12.2024'
,'33575.INV.2004.12.2024'
,'33576.INV.2004.12.2024'
,'33587.INV.2004.12.2024'
,'33596.INV.2004.12.2024'
,'33580.INV.2004.12.2024'
,'33581.INV.2004.12.2024'
,'33584.INV.2004.12.2024'
,'33573.INV.2004.12.2024'
,'33579.INV.2004.12.2024'
,'33583.INV.2004.12.2024'
,'33582.INV.2004.12.2024'
,'33586.INV.2004.12.2024'
,'33574.INV.2004.12.2024'
,'33585.INV.2004.12.2024'
,'33633.INV.1000.12.2024'
)
UPDATE dbo.INVOICE SET INVOICE_DUE_DATE = DATEADD(MONTH,2,DATEADD(day,1,INVOICE_DUE_DATE)) WHERE INVOICE_NO IN ( 
'33578.INV.2004.12.2024'
,'33577.INV.2004.12.2024'
,'33575.INV.2004.12.2024'
,'33576.INV.2004.12.2024'
,'33587.INV.2004.12.2024'
,'33596.INV.2004.12.2024'
,'33580.INV.2004.12.2024'
,'33581.INV.2004.12.2024'
,'33584.INV.2004.12.2024'
,'33573.INV.2004.12.2024'
,'33579.INV.2004.12.2024'
,'33583.INV.2004.12.2024'
,'33582.INV.2004.12.2024'
,'33586.INV.2004.12.2024'
,'33574.INV.2004.12.2024'
,'33585.INV.2004.12.2024'
)
UPDATE dbo.INVOICE SET INVOICE_DUE_DATE = DATEADD(MONTH,3,DATEADD(day,-12,INVOICE_DUE_DATE)) WHERE INVOICE_NO = '33633.INV.1000.12.2024'

SELECT * FROM dbo.INVOICE WHERE INVOICE_NO IN ( 
'33578.INV.2004.12.2024'
,'33577.INV.2004.12.2024'
,'33575.INV.2004.12.2024'
,'33576.INV.2004.12.2024'
,'33587.INV.2004.12.2024'
,'33596.INV.2004.12.2024'
,'33580.INV.2004.12.2024'
,'33581.INV.2004.12.2024'
,'33584.INV.2004.12.2024'
,'33573.INV.2004.12.2024'
,'33579.INV.2004.12.2024'
,'33583.INV.2004.12.2024'
,'33582.INV.2004.12.2024'
,'33586.INV.2004.12.2024'
,'33574.INV.2004.12.2024'
,'33585.INV.2004.12.2024'
,'33633.INV.1000.12.2024'
)

SELECT * FROM  AGREEMENT_OBLIGATION WHERE INVOICE_NO IN ( 
'33578.INV.2004.12.2024'
,'33577.INV.2004.12.2024'
,'33575.INV.2004.12.2024'
,'33576.INV.2004.12.2024'
,'33587.INV.2004.12.2024'
,'33596.INV.2004.12.2024'
,'33580.INV.2004.12.2024'
,'33581.INV.2004.12.2024'
,'33584.INV.2004.12.2024'
,'33573.INV.2004.12.2024'
,'33579.INV.2004.12.2024'
,'33583.INV.2004.12.2024'
,'33582.INV.2004.12.2024'
,'33586.INV.2004.12.2024'
,'33574.INV.2004.12.2024'
,'33585.INV.2004.12.2024'
,'33633.INV.1000.12.2024'
)

DELETE AGREEMENT_OBLIGATION WHERE INVOICE_NO IN ( 
'33578.INV.2004.12.2024'
,'33577.INV.2004.12.2024'
,'33575.INV.2004.12.2024'
,'33576.INV.2004.12.2024'
,'33587.INV.2004.12.2024'
,'33596.INV.2004.12.2024'
,'33580.INV.2004.12.2024'
,'33581.INV.2004.12.2024'
,'33584.INV.2004.12.2024'
,'33573.INV.2004.12.2024'
,'33579.INV.2004.12.2024'
,'33583.INV.2004.12.2024'
,'33582.INV.2004.12.2024'
,'33586.INV.2004.12.2024'
,'33574.INV.2004.12.2024'
,'33585.INV.2004.12.2024'
,'33633.INV.1000.12.2024'
)

SELECT * FROM  AGREEMENT_OBLIGATION WHERE INVOICE_NO IN ( 
'33578.INV.2004.12.2024'
,'33577.INV.2004.12.2024'
,'33575.INV.2004.12.2024'
,'33576.INV.2004.12.2024'
,'33587.INV.2004.12.2024'
,'33596.INV.2004.12.2024'
,'33580.INV.2004.12.2024'
,'33581.INV.2004.12.2024'
,'33584.INV.2004.12.2024'
,'33573.INV.2004.12.2024'
,'33579.INV.2004.12.2024'
,'33583.INV.2004.12.2024'
,'33582.INV.2004.12.2024'
,'33586.INV.2004.12.2024'
,'33574.INV.2004.12.2024'
,'33585.INV.2004.12.2024'
,'33633.INV.1000.12.2024'
)

SELECT DISTINCT AGREEMENT_OBLIGATION.CODE, dbo.AGREEMENT_INFORMATION.AGREEMENT_NO,OVD_DAYS FROM AGREEMENT_INFORMATION JOIN dbo.AGREEMENT_OBLIGATION ON AGREEMENT_OBLIGATION.AGREEMENT_NO = AGREEMENT_INFORMATION.AGREEMENT_NO
WHERE INVOICE_NO IN ( 
'33578.INV.2004.12.2024'
,'33577.INV.2004.12.2024'
,'33575.INV.2004.12.2024'
,'33576.INV.2004.12.2024'
,'33587.INV.2004.12.2024'
,'33596.INV.2004.12.2024'
,'33580.INV.2004.12.2024'
,'33581.INV.2004.12.2024'
,'33584.INV.2004.12.2024'
,'33573.INV.2004.12.2024'
,'33579.INV.2004.12.2024'
,'33583.INV.2004.12.2024'
,'33582.INV.2004.12.2024'
,'33586.INV.2004.12.2024'
,'33574.INV.2004.12.2024'
,'33585.INV.2004.12.2024'
,'33633.INV.1000.12.2024'
)


--SELECT * FROM dbo.AGREEMENT_OBLIGATION_PAYMENT WHERE OBLIGATION_CODE IN
--(
--N'OPLAOB.2501.003946',
--N'OPLAOB.2501.003947',
--N'OPLAOB.2501.003948',
--N'OPLAOB.2501.003949',
--N'OPLAOB.2501.003951',
--N'OPLAOB.2501.003952',
--N'OPLAOB.2501.003950',
--N'OPLAOB.2501.003926',
--N'OPLAOB.2501.003927',
--N'OPLAOB.2501.003928',
--N'OPLAOB.2501.003964',
--N'OPLAOB.2501.003965',
--N'OPLAOB.2501.003966',
--N'OPLAOB.2501.003967',
--N'OPLAOB.2501.003968',
--N'OPLAOB.2501.003938',
--N'OPLAOB.2501.003939',
--N'OPLAOB.2501.003940',
--N'OPLAOB.2501.003941',
--N'OPLAOB.2501.003942',
--N'OPLAOB.2501.003934',
--N'OPLAOB.2501.003944',
--N'OPLAOB.2501.003945',
--N'OPLAOB.2501.003935',
--N'OPLAOB.2501.003936',
--N'OPLAOB.2501.003937',
--N'OPLAOB.2501.003929',
--N'OPLAOB.2501.003930',
--N'OPLAOB.2501.003931',
--N'OPLAOB.2501.003932',
--N'OPLAOB.2501.003933',
--N'OPLAOB.2501.003953',
--N'OPLAOB.2501.003954',
--N'OPLAOB.2501.003955',
--N'OPLAOB.2501.003956',
--N'OPLAOB.2501.003957',
--N'OPLAOB.2501.003958',
--N'OPLAOB.2501.003959',
--N'OPLAOB.2501.003960',
--N'OPLAOB.2501.003961',
--N'OPLAOB.2501.003962',
--N'OPLAOB.2501.003963',
--N'OPLAOB.2501.003925',
--N'OPLAOB.2501.003943',
--N'OPLAOB.2501.005977',
--N'OPLAOB.2501.005978',
--N'OPLAOB.2501.003974',
--N'OPLAOB.2501.003975',
--N'OPLAOB.2501.003976',
--N'OPLAOB.2501.003977',
--N'OPLAOB.2501.003978',
--N'OPLAOB.2501.003979',
--N'OPLAOB.2501.003980',
--N'OPLAOB.2501.003969',
--N'OPLAOB.2501.003970',
--N'OPLAOB.2501.003971',
--N'OPLAOB.2501.003972',
--N'OPLAOB.2501.003973'
--)


ROLLBACK TRANSACTION 